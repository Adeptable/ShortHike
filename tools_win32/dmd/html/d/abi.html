
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<!--
	Copyright (c) 1999-2006 by Digital Mars
	All Rights Reserved
	Written by Walter Bright
	www.digitalmars.com
  -->


<!-- Mirrored from www.shorthike.com/trac/browser/trunk/tools_win32/dmd/html/d/abi.html?format=raw by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 01 May 2010 04:11:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="keywords" content="D programming language" />
<meta name="description" content="D Programming Language" />
<title>D Programming Language - Application Binary Interface</title>
<link rel="stylesheet" type="text/css" href="style.html" />
<link rel="shortcut icon" href="favicon.html" />
</head>

<body>
<div id="heading">
	<a href="http://www.digitalmars.com/"><img src="dmlogo.html" width="270" height="53" style="border-style:none" alt="www.digitalmars.com"></a>

	<div id="headingNav">
	<ul>	<li><a href="http://www.prowiki.org/wiki4d/wiki.cgi?DocComments/ABI" title="Read/write comments and feedback">Comments</a></li>
	<li><a href="index.html" title="D Programming Language" class="dlink">D</a></li>
	<li><a href="http://www.digitalmars.com/advancedsearch.html" title="Search Digital Mars web site">Search</a></li>
	<li><a href="download.html" title="download D">Downloads</a></li>
	<li><a href="http://www.digitalmars.com/" title="www.digitalmars.com">Home</a></li>
	</ul>
	</div>

	<div id="lastupdate">Last update Fri Jun 16 00:33:14 2006
</div>
</div>

<!-- Generated by Ddoc from abi.d -->



<div id="navigation">
  
<div class="navblock">
<form method="get" action="http://www.google.com/search">
<div id="searchbox">
<input id="q" name="q" size="10" value="Search" onFocus='if(this.value == "Search"){this.value="";}'>
<input type="hidden" id="domains" name="domains" value="www.digitalmars.com">
<input type="hidden" id="sitesearch" name="sitesearch" value="www.digitalmars.com/d">
<input type="hidden" id="sourceid" name="sourceid" value="google-search">
<input type="submit" id="submit" name="submit" value="Go">
</div>
</form>
<div id="toctop">
    <ul>	<li><a href="index.html" title="D Programming Language">D ...</a></li>
	<li><a href="lex.html" title="D Language Specification">Language ...</a></li>
	<li><a href="phobos/phobos.html" title="D Runtime Library">Phobos ...</a></li>
	<li><a href="comparison.html" title="Language Comparisons">Comparisons ...</a></li>
    </ul>
</div>
</div>

  
    <div class="navblock">
    <ul>	<li><a href="lex.html">Lexical</a></li>

	<li><a href="module.html">Modules</a></li>

	<li><a href="declaration.html">Declarations</a></li>

	<li><a href="type.html">Types</a></li>

	<li><a href="property.html">Properties</a></li>

	<li><a href="attribute.html">Attributes</a></li>

	<li><a href="pragma.html">Pragmas</a></li>

	<li><a href="expression.html">Expressions</a></li>

	<li><a href="statement.html">Statements</a></li>

	<li><a href="arrays.html">Arrays</a></li>

	<li><a href="struct.html">Structs &amp; Unions</a></li>

	<li><a href="class.html">Classes</a></li>

	<li><a href="interface.html">Interfaces</a></li>

	<li><a href="enum.html">Enums</a></li>

	<li><a href="function.html">Functions</a></li>

	<li><a href="operatoroverloading.html">Operator Overloading</a></li>

	<li><a href="template.html">Templates</a></li>

	<li><a href="mixin.html">Mixins</a></li>

	<li><a href="dbc.html">Contracts</a></li>

	<li><a href="version.html">Conditional Compilation</a></li>

	<li><a href="errors.html">Handling errors</a></li>

	<li><a href="garbage.html">Garbage Collection</a></li>

	<li><a href="float.html">Floating Point</a></li>

	<li><a href="iasm.html">Inline Assembler</a></li>

	<li><a href="ddoc.html">Documentation Comments</a></li>

	<li><a href="interfaceToC.html">Interfacing To C</a></li>

	<li><a href="portability.html">Portability Guide</a></li>

	<li><a href="html.html">Embedding D in HTML</a></li>

	<li><a href="entity.html">Named Character Entities</a></li>

	<li><a href="abi.html">Application Binary Interface</a></li>

    </ul>
    </div>

</div>
<div id="content">
  <h1>     D Application Binary Interface</h1>
  
	A D implementation that conforms to the D ABI (Application Binary Interface)
	will be able to generate libraries, DLL's, etc., that can interoperate with
	D binaries built by other implementations.
	<p>

	Most of this specification remains TBD (To Be Defined).

<h3>C ABI</h3>

	The C ABI referred to in this specification means the C Application
	Binary Interface of the target system.
	C and D code should be freely linkable together, in particular, D
	code shall have access to the entire C ABI runtime library.

<h3>Basic Types</h3>

	TBD

<h3>Structs</h3>

	Conforms to the target's C ABI struct layout.

<h3>Classes</h3>

	An object consists of:
	<p>

<table>
<tr>
<th> offset <th> contents
<tr> <td> 0	<td> pointer to vtable
<tr> <td> 4	<td> monitor
<tr> <td> 8...	<td> non-static members
</table>
	<p>

	The vtable consists of:
	<p>

<table>
<tr>
<th> offset <th> contents
<tr> <td> 0	<td> pointer to instance of ClassInfo
<tr> <td> 4...	<td> pointers to virtual member functions
</table>
	<p>

	The class definition:

<pre class="d_code"><span class="d_keyword">class</span> XXXX
{
    ....
};
</pre>

	Generates the following:

	<ul>
	<li> An instance of Class called ClassXXXX.

	<li> A type called StaticClassXXXX which defines all the static members.

	<li> An instance of StaticClassXXXX called StaticXXXX for the static members.
	</ul>

<h3>Interfaces</h3>

	TBD

<h3>Arrays</h3>

	A dynamic array consists of:
	<p>

<table>
<tr>
<th> offset <th> contents
<tr> <td> 0	<td> array dimension
<tr> <td> 4	<td> pointer to array data
</table>
<p>

	A dynamic array is declared as:

<pre class="d_code">type array[];
</pre>

	whereas a static array is declared as:

<pre class="d_code">type array[dimension];
</pre>

	Thus, a static array always has the dimension statically available as part of the type, and
	so it is implemented like in C. Static array's and Dynamic arrays can be easily converted back
	and forth to each other.


<h3>Associative Arrays</h3>

	TBD

<h3>Reference Types</h3>

	D has reference types, but they are implicit. For example, classes are always
	referred to by reference; this means that class instances can never reside on the stack
	or be passed as function parameters.
	<p>

	When passing a static array to a function, the result, although declared as a static array, will
	actually be a reference to a static array. For example:

<pre class="d_code"><span class="d_keyword">int</span>[3] abc;
</pre>

	Passing abc to functions results in these implicit conversions:

<pre class="d_code"><span class="d_keyword">void</span> func(<span class="d_keyword">int</span>[3] array); <span class="d_comment">// actually &lt;reference to&gt;&lt;array[3] of&gt;&lt;int&gt;
</span><span class="d_keyword">void</span> func(<span class="d_keyword">int</span>* p);       <span class="d_comment">// abc is converted to a pointer
</span>			 <span class="d_comment">// to the first element
</span><span class="d_keyword">void</span> func(<span class="d_keyword">int</span>[] array);	 <span class="d_comment">// abc is converted to a dynamic array
</span></pre>


<h3>Name Mangling</h3>

	D accomplishes typesafe linking by <i>mangling</i> a D identifier
	to include scope and type information.

<pre class="bnf"><i>MangledName</i>:
    <b>_D</b> <i>QualifiedName</i> <i>Type</i>

<i>QualifiedName</i>:
    <i>SymbolName</i>
    <i>SymbolName</i> <i>QualifiedName</i>

<i>SymbolName</i>:
    <i>LName</i>
    <i>TemplateInstanceName</i>
</pre>

	Template Instance Names have the types and values of its parameters
	encoded into it:

<pre class="bnf"><i>TemplateInstanceName</i>:
     <b>__T</b> <i>LName</i> <i>TemplateArgs</i> <b>Z</b>

<i>TemplateArgs</i>:
    <i>TemplateArg</i>
    <i>TemplateArg</i> <i>TemplateArgs</i>

<i>TemplateArg</i>:
    <b>T</b> <i>Type</i>
    <b>V</b> <i>Type</i> <i>Value</i>
    <b>S</b> <i>LName</i>

<i>Value</i>:
    <b>n</b>
    <i>Number</i>
    <b>N</b> <i>Number</i>
    <b>e</b> <i>20HexDigits</i>
    <b>c</b> <i>20HexDigits</i> <i>20HexDigits</i>

<i>HexDigits</i>:
    <i>HexDigit</i>
    <i>HexDigit</i> <i>HexDigits</i>

<i>HexDigit</i>:
    <i>Digit</i>
    <b>a</b>
    <b>b</b>
    <b>c</b>
    <b>d</b>
    <b>e</b>
    <b>f</b>
</pre>

	<i>n</i> is for <b>null</b> arguments.<br>
	<i>Number</i> is for positive numeric literals (including
	character literals).<br>
	<b>N</b> <i>Number</i> is for negative numeric literals.<br>
	<b>e</b> <i>20HexDigits</i> is for real and imaginary floating point literals.<br>
	<b>c</b> <i>20HexDigits</i> <i>20HexDigits</i> is for complex floating point literals.<br>
	<i>Width</i> <i>Number</i> <b>_</b> <i>HexDigits</i>:
	<i>Width</i> is whether the characters
	are 1 byte (<b>a</b>), 2 bytes (<b>w</b>) or 4 bytes (<b>d</b>) in size.
	<i>Number</i> is the number of characters in the string.
	The <i>HexDigits</i> are the hex data for the string.

<pre class="bnf"><i>Name</i>:
    <i>Namestart</i>
    <i>Namestart</i> <i>Namechars</i>

<i>Namestart</i>:
    <b>_</b>
    <i>Alpha</i>

<i>Namechar</i>:
    <i>Namestart</i>
    <i>Digit</i>

<i>Namechars</i>:
    <i>Namechar</i>
    <i>Namechar</i> <i>Namechars</i>
</pre>

<pre class="bnf"><i>Type</i>:
	TBD
</pre>

	A <i>Name</i> is a standard D identifier.

<pre class="bnf"><i>LName</i>:
    <i>Number</i> <i>Name</i>

<i>Number</i>:
    <i>Digit</i>
    <i>Digit</i> <i>Number</i>

<i>Digit</i>:
    <b>0</b>
    <b>1</b>
    <b>2</b>
    <b>3</b>
    <b>4</b>
    <b>5</b>
    <b>6</b>
    <b>7</b>
    <b>8</b>
    <b>9</b>
</pre>

	An <i>LName</i> is a name preceded by a <i>Number</i> giving
	the number of characters in the <i>Name</i>.

<h3>Function Calling Conventions</h3>

	TBD

<h3>Exception Handling</h3>

    <h4>Windows</h4>

	Conforms to the Microsoft Windows Structured Exception Handling
	conventions.
	TBD

    <h4>Linux</h4>

	Uses static address range/handler tables.
	TBD

<h3>Garbage Collection</h3>

	TBD

<h3>Runtime Helper Functions</h3>

	TBD

<h3>Module Initialization and Termination</h3>

	TBD

<h3>Unit Testing</h3>

	TBD


  
<br><br>
<br><br>
<!-- Google ad -->
<script type="text/javascript"><!--
/**/google_ad_client = "pub-5628673096434613";
/**/google_ad_width = 728;
/**/google_ad_height = 90;
/**/google_ad_format = "728x90_as";
/**/google_ad_channel ="3651639259";
/**/google_page_url = document.location;
//--></script>
<script type="text/javascript" src="../../../../../../../../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

</div>





<div id="copyright">
Copyright &copy; 1999-2006 by Digital Mars, All Rights Reserved |
Page generated by <a href="http://www.digitalmars.com/d/ddoc.html">Ddoc</a>. |
<a href="http://www.prowiki.org/wiki4d/wiki.cgi?DocComments/ABI" title="Read/write comments and feedback">Comments</a>
</div>

</body>

<!-- Mirrored from www.shorthike.com/trac/browser/trunk/tools_win32/dmd/html/d/abi.html?format=raw by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 01 May 2010 04:11:25 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>

